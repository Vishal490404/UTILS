#if 0
	shc Version 4.0.3, Generic Shell Script Compiler
	GNU GPL Version 3 Md Jahidul Hamid <jahidulhamid@yahoo.com>

	shc -f script.sh 
#endif

static  char data [] = 
#define      chk1_z	22
#define      chk1	((&data[4]))
	"\103\064\306\250\245\222\056\030\047\125\366\335\241\341\055\253"
	"\025\316\202\003\053\353\243\142\132\246\104\174\116\234\167"
#define      tst1_z	22
#define      tst1	((&data[34]))
	"\032\152\024\322\220\143\326\107\041\307\014\071\143\310\007\126"
	"\276\041\372\176\234\351\316\137\251\206\005\155\341\373"
#define      msg2_z	19
#define      msg2	((&data[61]))
	"\355\176\027\322\224\237\354\341\074\324\132\306\150\076\045\142"
	"\245\357\312"
#define      opts_z	1
#define      opts	((&data[80]))
	"\133"
#define      inlo_z	3
#define      inlo	((&data[81]))
	"\042\176\102"
#define      chk2_z	19
#define      chk2	((&data[85]))
	"\047\011\374\344\056\177\223\001\027\357\225\235\135\356\331\162"
	"\320\045\105\265"
#define      msg1_z	65
#define      msg1	((&data[118]))
	"\217\044\011\006\252\244\340\305\017\364\113\024\142\055\206\363"
	"\221\176\137\357\074\041\156\071\123\115\205\333\055\341\061\021"
	"\204\033\171\070\234\154\213\252\241\324\107\002\124\236\347\247"
	"\110\137\326\014\046\046\025\037\230\066\311\113\022\245\074\354"
	"\103\165\375\035\154\315\267\034\230\221\217\112\256\207\055\020"
	"\350\063\067\260\341\224"
#define      pswd_z	256
#define      pswd	((&data[202]))
	"\353\176\255\023\221\204\177\040\251\211\047\124\263\135\352\040"
	"\002\315\334\254\234\232\320\063\324\200\023\312\356\076\261\056"
	"\345\040\200\274\032\154\215\332\001\353\102\264\110\054\325\112"
	"\372\262\367\226\114\310\312\041\110\335\353\067\033\235\145\001"
	"\275\345\275\330\122\112\263\124\065\365\011\175\041\337\310\034"
	"\221\300\263\336\210\175\377\320\133\353\010\166\210\156\170\106"
	"\124\065\037\246\200\322\373\266\307\004\064\351\343\375\005\165"
	"\275\270\123\105\066\123\026\221\077\037\010\310\215\200\016\341"
	"\266\056\210\067\000\203\356\310\210\042\261\154\040\267\341\335"
	"\160\065\043\246\210\071\070\307\130\100\217\346\301\236\307\170"
	"\315\117\257\316\323\236\226\133\300\110\310\340\377\251\276\160"
	"\336\341\027\147\033\117\057\164\220\277\132\122\136\042\312\053"
	"\162\172\371\105\030\220\241\331\330\151\272\330\023\170\110\361"
	"\132\140\131\165\257\210\352\100\107\104\222\246\146\134\321\330"
	"\327\313\036\357\133\277\311\064\051\203\014\074\374\125\056\126"
	"\265\207\314\145\020\266\245\130\372\067\376\141\224\317\072\153"
	"\232\131\133\366\030\044\052\102\247\067\176\243\055\010\031\074"
	"\374\144\121\136\221\142\107\305\231\370\246\056\357\331\255\333"
	"\127\133\356\351\337\156\012\210\367\061\334\045"
#define      shll_z	10
#define      shll	((&data[492]))
	"\066\132\367\200\200\323\077\371\214\113\172\340\264"
#define      rlax_z	1
#define      rlax	((&data[503]))
	"\104"
#define      text_z	4773
#define      text	((&data[1333]))
	"\325\127\337\305\061\214\240\211\347\217\162\307\375\174\117\365"
	"\256\053\032\350\041\174\036\174\060\264\150\107\221\032\370\147"
	"\162\327\054\243\143\314\054\113\134\237\022\131\033\142\116\311"
	"\215\150\261\257\345\320\053\025\205\223\135\026\256\125\175\041"
	"\054\252\304\220\167\361\334\323\220\357\054\253\121\173\165\337"
	"\344\047\216\311\367\271\337\175\115\074\223\374\222\021\035\276"
	"\274\341\117\063\323\053\006\143\032\063\017\154\256\204\113\222"
	"\253\332\134\243\223\073\040\341\170\264\335\012\306\373\311\202"
	"\335\030\265\260\104\274\023\137\357\042\313\236\247\027\061\122"
	"\361\216\366\205\311\026\147\102\313\105\115\221\100\026\024\035"
	"\057\312\315\163\206\340\322\166\003\236\025\252\265\107\375\247"
	"\325\363\055\236\012\224\341\326\331\056\147\031\104\174\066\163"
	"\106\004\347\315\345\272\103\350\130\131\223\016\240\220\266\165"
	"\204\343\024\216\170\365\145\122\044\314\153\150\111\242\334\217"
	"\247\304\134\214\176\240\164\327\371\007\345\232\230\234\017\034"
	"\177\043\253\370\031\020\112\075\335\266\246\046\130\203\266\000"
	"\107\022\214\306\263\001\235\254\011\203\107\241\037\126\276\237"
	"\172\152\227\223\173\341\321\130\227\170\177\360\373\065\360\103"
	"\110\174\011\373\176\247\250\207\052\357\050\111\106\347\350\300"
	"\121\200\124\314\141\046\045\371\236\244\351\231\332\332\335\042"
	"\126\346\036\324\215\306\134\270\266\205\001\374\154\352\274\275"
	"\152\021\212\314\067\257\305\325\124\257\157\057\211\114\122\340"
	"\062\160\264\300\066\021\170\355\226\172\351\002\145\245\300\320"
	"\266\113\234\355\373\142\302\117\021\062\177\232\176\321\172\261"
	"\101\057\161\170\100\352\145\326\145\116\331\313\364\232\233\253"
	"\345\067\230\340\232\133\060\253\215\257\105\013\200\300\275\302"
	"\357\057\073\060\031\240\007\177\357\340\112\343\173\345\216\140"
	"\035\047\101\267\203\161\143\021\041\251\035\242\151\332\145\131"
	"\011\240\211\043\100\220\242\060\161\355\024\354\323\242\115\360"
	"\312\216\250\115\000\014\136\042\265\174\304\037\126\051\170\137"
	"\312\001\202\013\222\045\073\004\022\117\360\345\362\076\326\274"
	"\314\177\012\315\213\151\357\101\345\264\140\073\336\330\233\250"
	"\332\036\263\155\103\356\161\126\076\142\074\060\240\022\355\155"
	"\222\370\072\036\141\052\137\107\336\277\203\274\230\037\144\163"
	"\075\027\340\200\006\122\327\104\264\023\165\125\045\142\302\270"
	"\132\375\326\274\047\065\004\005\365\207\302\216\246\047\001\343"
	"\077\342\144\105\064\074\212\351\117\377\077\165\142\001\055\274"
	"\377\003\171\046\071\175\054\056\005\357\275\254\026\276\217\125"
	"\241\364\233\325\060\045\277\200\044\376\365\206\000\043\103\377"
	"\046\274\046\140\072\123\216\077\102\113\353\130\012\173\256\253"
	"\160\111\201\241\156\101\042\223\100\027\031\100\072\135\100\141"
	"\032\146\301\124\271\120\224\374\234\200\124\247\374\003\123\154"
	"\114\324\016\272\026\060\115\126\110\147\226\203\304\327\344\336"
	"\075\246\063\367\367\307\363\223\110\110\072\104\113\216\261\227"
	"\142\300\122\171\360\240\317\071\007\146\274\314\075\241\253\172"
	"\110\336\162\077\246\145\323\356\256\016\063\371\234\344\221\377"
	"\244\343\170\225\204\110\317\214\256\214\130\353\056\003\146\166"
	"\342\331\266\211\076\211\167\354\230\252\346\064\217\167\064\064"
	"\133\254\311\337\364\231\153\243\045\304\217\123\310\366\312\253"
	"\317\200\064\015\012\253\372\242\126\341\327\346\130\013\032\264"
	"\270\344\224\255\175\000\120\243\304\340\367\215\326\301\070\245"
	"\101\154\263\114\030\256\357\157\217\306\125\350\322\337\101\347"
	"\073\264\316\037\355\302\206\015\121\074\365\350\364\123\074\323"
	"\037\062\342\360\371\020\157\266\057\044\375\044\024\001\212\107"
	"\321\124\263\360\112\202\055\272\225\064\335\000\275\145\171\071"
	"\124\074\061\274\252\233\065\306\133\273\167\357\201\065\216\264"
	"\320\311\321\123\124\103\154\056\265\263\057\067\121\262\302\255"
	"\062\204\231\111\366\317\327\116\253\117\300\302\322\035\154\277"
	"\045\364\227\114\065\341\212\332\003\317\050\073\172\262\000\112"
	"\001\352\007\362\302\015\116\271\135\166\037\332\373\106\143\144"
	"\243\346\367\375\123\065\144\371\113\200\327\021\377\156\240\226"
	"\237\106\045\262\166\054\017\231\231\047\360\134\064\115\222\057"
	"\233\247\241\324\173\072\322\211\274\175\100\305\361\015\303\000"
	"\003\270\303\172\363\260\026\222\367\323\001\205\212\061\243\322"
	"\013\147\263\353\074\274\350\324\305\274\024\342\105\064\056\032"
	"\266\227\141\343\307\175\143\027\337\304\037\040\174\117\202\350"
	"\107\106\071\226\213\265\031\137\030\214\155\204\123\226\175\243"
	"\206\032\072\062\027\053\375\123\100\354\176\014\002\274\035\311"
	"\205\225\005\237\142\157\334\050\006\336\142\341\117\115\170\207"
	"\031\161\345\250\145\235\024\201\315\021\102\326\144\165\325\044"
	"\231\070\103\163\060\353\272\205\133\361\277\356\102\166\015\256"
	"\213\007\012\207\134\376\161\373\315\330\346\057\305\170\207\042"
	"\062\105\114\054\106\311\022\153\230\307\125\016\235\332\137\020"
	"\163\276\250\247\116\215\104\346\321\300\037\107\066\015\272\167"
	"\314\122\116\313\370\344\100\253\145\220\126\345\276\111\064\374"
	"\012\014\276\234\235\103\326\017\244\267\067\017\351\031\205\160"
	"\354\261\071\276\040\223\332\116\061\032\270\365\164\064\120\171"
	"\253\260\075\211\220\012\045\134\016\354\274\001\160\143\140\360"
	"\333\336\064\305\331\257\172\201\305\140\132\367\001\263\034\226"
	"\153\106\276\354\110\206\260\030\300\167\346\362\301\112\071\340"
	"\050\370\262\323\155\236\144\236\050\126\260\244\070\362\077\374"
	"\070\111\252\354\024\353\040\126\265\274\144\204\123\304\142\351"
	"\207\103\350\074\220\057\303\364\301\107\040\354\306\262\153\171"
	"\050\264\267\277\202\231\257\201\373\225\142\224\277\310\272\227"
	"\302\163\124\147\141\242\063\051\226\123\204\325\003\243\353\357"
	"\164\203\065\137\054\104\251\165\325\150\050\222\001\226\233\006"
	"\225\202\367\153\165\201\341\267\151\072\250\156\225\134\017\344"
	"\200\236\177\253\040\256\001\143\254\035\361\153\007\253\041\147"
	"\343\035\320\251\213\314\342\044\052\344\353\147\224\251\240\114"
	"\135\142\072\177\143\200\117\121\017\260\264\152\377\101\110\153"
	"\173\274\004\130\135\015\077\056\114\023\237\263\023\206\123\054"
	"\241\040\337\371\111\043\114\175\164\202\061\373\175\264\100\161"
	"\126\132\323\226\331\134\351\003\062\262\265\256\133\326\304\321"
	"\236\243\050\134\317\132\004\277\016\247\213\222\046\050\074\271"
	"\310\134\003\354\353\217\056\173\203\326\326\072\153\254\222\350"
	"\175\372\306\072\236\271\246\076\354\313\170\151\312\261\313\040"
	"\147\243\273\201\172\001\037\207\243\042\123\001\064\353\205\040"
	"\371\131\022\015\065\312\360\240\113\234\233\121\321\125\100\147"
	"\221\353\241\220\174\262\047\115\025\222\231\250\237\016\146\304"
	"\115\353\020\354\005\370\323\336\146\341\201\241\046\145\043\140"
	"\005\343\004\041\061\011\016\035\034\276\070\371\030\035\235\357"
	"\347\301\230\100\162\171\252\100\005\045\242\341\200\143\323\346"
	"\021\220\232\331\373\161\020\246\321\071\341\152\364\264\073\016"
	"\034\340\201\322\307\234\072\053\170\344\346\374\345\074\257\077"
	"\131\260\164\167\020\134\122\237\115\062\155\257\216\044\056\114"
	"\240\376\104\124\304\110\203\226\115\064\170\134\374\257\272\301"
	"\011\354\202\376\200\107\347\016\213\116\305\230\017\303\116\367"
	"\315\310\100\341\117\175\376\076\076\342\124\216\164\351\301\316"
	"\164\235\000\033\015\243\031\111\150\367\225\147\111\237\104\152"
	"\145\301\046\146\265\116\274\246\233\024\100\377\044\220\001\123"
	"\045\115\024\316\203\324\264\050\270\376\321\214\314\344\252\172"
	"\340\376\136\123\364\156\162\152\254\055\137\113\336\322\020\033"
	"\241\360\241\370\316\257\162\263\265\073\116\117\011\275\027\200"
	"\037\304\134\174\024\173\056\350\373\217\256\061\112\022\160\147"
	"\311\050\163\114\245\061\055\256\265\323\206\331\327\077\371\015"
	"\004\023\015\147\266\036\140\336\162\062\124\206\064\072\037\152"
	"\332\164\034\300\262\147\012\370\035\377\011\330\350\136\027\236"
	"\324\177\124\211\267\010\366\054\202\323\311\120\012\140\213\264"
	"\044\175\020\220\265\064\117\355\045\042\126\252\264\050\037\033"
	"\174\225\231\206\111\325\113\111\332\176\005\315\236\270\221\172"
	"\053\170\033\137\300\027\251\263\261\163\011\167\200\273\051\270"
	"\113\271\214\251\067\124\372\340\120\130\337\162\002\200\372\360"
	"\235\367\323\241\003\256\205\133\066\337\031\001\311\046\202\206"
	"\224\050\235\231\277\017\276\133\213\010\275\372\247\106\234\006"
	"\241\001\035\336\346\123\101\177\234\054\042\302\233\222\062\106"
	"\370\367\326\071\255\335\107\173\210\276\134\076\170\127\365\273"
	"\255\074\117\310\226\104\155\253\166\140\324\272\351\273\306\102"
	"\170\376\067\203\222\364\364\157\074\320\110\071\017\302\243\371"
	"\322\053\020\366\245\356\174\336\255\130\355\035\335\046\014\254"
	"\143\212\036\000\321\113\116\236\360\160\137\142\233\145\343\276"
	"\376\012\065\376\047\176\260\065\321\317\107\342\150\237\213\261"
	"\005\374\115\221\031\205\265\145\035\003\324\345\203\151\126\267"
	"\366\366\250\126\362\173\114\032\302\114\034\153\303\302\242\360"
	"\360\340\337\017\325\073\217\102\277\031\042\040\217\315\211\165"
	"\335\235\362\341\320\337\361\311\236\145\034\253\041\144\315\302"
	"\133\363\112\244\016\373\061\117\162\345\337\155\210\236\256\011"
	"\110\052\362\017\140\023\305\117\072\327\101\265\310\224\325\375"
	"\234\222\367\025\274\372\126\277\257\360\175\247\114\313\145\254"
	"\120\252\055\234\005\265\232\066\264\041\342\252\322\370\306\027"
	"\364\307\233\135\312\274\271\310\360\335\015\334\266\256\241\060"
	"\211\256\121\012\170\212\335\340\350\236\335\306\363\310\172\332"
	"\153\101\276\351\263\050\060\046\131\151\234\073\123\221\150\302"
	"\375\313\221\143\076\251\244\127\345\041\065\356\265\222\153\072"
	"\241\321\321\151\107\127\366\007\136\223\264\262\007\362\307\153"
	"\116\364\062\261\254\325\234\234\176\330\361\022\302\141\054\351"
	"\113\323\036\120\000\377\125\346\151\204\220\266\307\116\147\345"
	"\010\320\204\120\277\322\224\346\153\176\252\116\005\071\147\173"
	"\244\167\053\273\344\152\270\361\260\323\053\161\255\203\276\351"
	"\345\366\227\014\321\006\145\311\114\373\111\336\206\025\305\323"
	"\310\177\127\315\072\375\342\031\162\013\162\321\350\043\147\115"
	"\022\134\076\240\345\335\026\312\034\055\215\322\146\125\116\335"
	"\141\233\114\234\040\225\377\124\262\032\050\112\041\075\100\373"
	"\107\026\105\017\104\046\036\374\261\100\010\024\131\270\160\173"
	"\112\262\326\037\326\265\335\101\362\125\250\110\220\253\201\272"
	"\147\345\351\315\121\056\144\077\350\145\044\057\273\014\005\154"
	"\355\377\173\061\026\065\034\266\052\355\207\306\153\232\064\163"
	"\323\261\010\266\245\221\374\051\217\347\150\230\071\320\051\263"
	"\171\166\325\346\242\236\334\160\323\117\373\201\352\221\365\177"
	"\164\014\156\107\343\154\032\250\170\171\375\160\016\162\225\053"
	"\241\272\361\215\331\331\341\067\230\220\150\367\134\227\226\260"
	"\374\052\276\120\314\336\015\016\352\024\372\207\272\265\302\273"
	"\230\316\151\064\311\147\124\257\126\022\112\037\305\256\255\305"
	"\342\066\357\151\150\106\163\232\021\277\356\204\007\256\071\013"
	"\143\154\237\325\066\136\312\312\300\163\053\254\050\113\344\134"
	"\011\157\372\124\051\205\303\125\000\236\120\146\227\171\322\217"
	"\163\116\326\334\105\366\233\031\320\201\017\376\143\237\005\364"
	"\044\205\136\114\060\174\361\273\117\276\240\151\242\315\122\103"
	"\207\321\275\260\052\142\153\042\231\056\123\342\251\344\010\353"
	"\041\262\037\174\350\274\111\032\240\206\071\062\233\353\061\037"
	"\255\247\221\015\220\331\035\325\140\337\027\203\065\323\064\076"
	"\063\213\035\071\175\136\072\033\045\022\222\231\256\325\075\213"
	"\347\147\146\203\224\335\065\226\373\236\366\263\111\102\150\007"
	"\124\126\013\111\330\070\161\173\070\331\206\111\100\242\222\372"
	"\205\160\153\010\111\356\101\275\114\036\056\150\125\345\345\001"
	"\054\110\143\270\142\073\240\356\076\354\314\275\037\362\075\172"
	"\000\312\012\053\110\021\032\236\311\061\014\174\231\031\207\153"
	"\110\100\203\270\204\130\046\277\123\045\004\046\100\254\242\032"
	"\122\275\115\201\007\231\007\225\017\127\372\115\005\171\076\230"
	"\226\070\223\277\300\362\052\013\370\260\063\134\135\236\014\372"
	"\050\004\255\112\167\242\140\017\070\223\372\117\254\125\005\043"
	"\205\350\052\376\372\160\303\254\106\153\043\003\350\011\227\244"
	"\334\342\277\364\244\366\356\053\236\114\303\040\361\205\101\012"
	"\161\347\276\276\031\022\213\374\227\161\100\231\243\164\041\243"
	"\014\207\021\202\221\123\350\122\147\365\171\326\253\055\024\150"
	"\217\156\222\267\066\061\141\117\172\242\024\316\166\130\142\236"
	"\322\164\017\133\064\023\161\036\343\011\157\134\275\374\032\377"
	"\140\337\244\376\172\145\233\330\021\064\051\246\363\072\064\333"
	"\070\276\357\061\061\221\333\232\347\214\067\262\271\351\124\170"
	"\246\203\245\310\150\024\235\127\013\132\245\117\302\331\343\303"
	"\312\270\306\331\044\350\173\010\150\030\017\113\166\113\337\033"
	"\277\115\121\126\364\050\302\207\163\125\321\320\103\126\246\155"
	"\372\103\077\052\327\312\327\325\343\216\243\137\045\262\374\053"
	"\376\053\177\156\121\366\054\256\153\172\132\377\333\173\336\256"
	"\212\200\006\374\350\375\245\041\357\167\242\355\063\236\055\045"
	"\220\354\025\376\102\251\002\006\164\131\350\373\247\131\357\231"
	"\374\322\037\063\302\206\301\125\342\035\212\337\302\175\362\253"
	"\313\161\155\176\346\262\061\016\023\170\013\037\306\262\005\144"
	"\157\044\010\344\101\132\324\066\224\137\320\160\116\157\242\053"
	"\071\351\100\114\372\332\057\075\064\375\234\112\107\245\022\377"
	"\031\317\351\053\272\210\255\142\155\055\337\222\145\010\152\121"
	"\255\303\114\152\002\136\170\226\317\246\122\133\315\027\326\275"
	"\011\313\110\170\056\072\200\237\145\301\107\371\015\346\152\352"
	"\130\121\256\203\252\245\322\063\150\156\163\063\137\350\164\005"
	"\135\064\002\243\142\275\374\160\377\132\231\310\370\167\025\071"
	"\257\364\306\120\270\351\220\027\035\243\175\316\041\062\301\042"
	"\146\224\217\224\076\130\330\332\237\301\030\155\322\356\223\326"
	"\271\247\311\166\027\077\267\166\140\304\223\235\321\012\220\103"
	"\202\313\272\024\137\377\005\315\377\076\012\056\346\272\374\273"
	"\034\017\366\250\273\376\247\072\231\130\025\021\315\357\247\055"
	"\070\233\071\370\344\033\053\244\020\177\047\164\001\326\152\234"
	"\147\366\176\033\070\120\035\374\010\302\354\255\341\165\262\100"
	"\143\113\312\150\254\126\243\316\341\164\210\025\164\240\361\350"
	"\137\366\141\216\032\230\066\167\041\060\102\045\071\345\234\025"
	"\053\251\225\172\044\257\042\103\213\053\013\143\321\226\072\065"
	"\063\166\230\116\056\030\220\133\227\171\222\023\366\351\112\031"
	"\314\133\016\261\371\225\063\220\163\151\375\075\012\264\160\044"
	"\143\075\006\234\320\030\350\122\023\135\067\226\073\035\034\102"
	"\200\171\215\152\164\162\052\273\115\037\105\073\353\375\364\351"
	"\146\210\077\010\164\304\353\031\232\123\317\057\072\343\326\207"
	"\032\150\061\306\053\175\252\110\014\241\146\356\327\367\055\111"
	"\235\331\032\100\363\246\005\136\057\023\174\037\312\261\325\172"
	"\133\266\143\344\133\212\365\343\044\372\336\305\140\026\071\200"
	"\100\036\325\270\113\225\156\045\123\102\077\340\137\236\330\100"
	"\005\210\326\235\073\201\305\260\021\371\222\231\354\361\155\307"
	"\004\152\374\004\164\001\165\344\121\057\231\251\161\005\066\063"
	"\364\276\065\305\100\325\221\256\146\332\107\351\224\202\057\025"
	"\205\170\375\343\044\374\240\324\211\177\367\145\324\136\265\017"
	"\306\030\326\271\026\130\333\164\216\021\201\357\203\102\067\137"
	"\116\244\346\145\136\024\206\156\026\127\332\361\360\326\337\037"
	"\104\374\101\032\022\057\066\125\366\242\134\353\020\174\067\161"
	"\067\276\241\012\036\027\004\177\114\134\307\343\326\331\274\230"
	"\336\124\060\212\156\364\242\251\366\345\042\152\207\153\052\073"
	"\057\171\032\231\267\111\111\155\176\036\063\363\215\257\210\073"
	"\311\250\011\113\343\222\121\230\166\163\314\034\263\057\021\202"
	"\176\247\274\314\032\164\307\060\124\105\362\112\032\367\170\374"
	"\173\056\015\362\043\047\360\017\356\024\132\177\214\333\234\123"
	"\276\361\345\173\154\143\147\144\165\247\364\231\327\254\161\374"
	"\077\100\256\055\002\345\213\025\165\254\116\056\341\100\246\216"
	"\241\304\104\271\246\005\067\125\267\040\360\142\131\113\376\344"
	"\154\316\104\065\005\050\355\017\077\326\344\132\067\075\232\331"
	"\331\114\312\310\171\136\242\054\054\177\355\370\273\106\260\242"
	"\173\040\310\220\264\250\021\346\214\215\105\317\227\021\272\332"
	"\013\270\022\363\330\212\007\072\265\273\167\260\202\201\372\255"
	"\321\115\131\143\256\104\117\041\245\275\332\317\005\112\275\061"
	"\320\123\151\205\113\001\161\263\231\273\367\366\007\065\261\277"
	"\244\111\110\215\057\244\066\177\133\026\045\300\032\073\360\337"
	"\106\157\111\244\162\036\332\065\077\344\326\214\026\147\327\277"
	"\340\304\004\014\320\070\366\313\366\016\242\015\056\161\152\105"
	"\211\047\062\365\031\222\243\273\036\012\220\327\037\315\272\041"
	"\035\046\327\051\267\213\072\152\051\064\024\134\011\102\252\250"
	"\101\226\371\331\236\146\053\110\301\371\100\250\265\073\255\046"
	"\246\342\023\154\026\306\025\005\177\021\356\037\052\306\331\202"
	"\240\146\331\011\000\330\044\257\061\335\076\046\021\306\360\321"
	"\341\173\114\017\017\137\311\205\300\206\016\302\173\133\223\156"
	"\054\377\266\305\153\265\110\373\354\265\143\025\040\115\122\374"
	"\060\351\365\142\331\111\010\167\064\223\366\117\205\042\116\234"
	"\175\164\313\305\213\022\000\060\062\273\134\052\275\050\341\075"
	"\161\105\304\242\042\342\065\150\334\356\337\066\023\374\213\166"
	"\244\332\057\163\147\022\014\071\115\350\153\243\006\266\065\044"
	"\357\011\320\217\303\305\274\205\156\325\224\042\047\012\136\203"
	"\201\272\203\044\326\377\211\040\352\055\330\144\140\253\064\202"
	"\305\176\323\302\127\011\030\332\065\050\002\253\355\373\165\360"
	"\202\342\365\224\067\106\205\327\031\271\231\227\146\151\332\217"
	"\015\006\110\125\054\175\317\177\001\336\020\212\064\012\167\330"
	"\107\363\103\156\254\254\042\044\274\364\253\166\332\010\164\350"
	"\054\055\307\277\312\065\254\273\062\114\117\204\110\242\057\072"
	"\271\012\015\073\200\244\130\047\262\215\241\372\047\247\154\040"
	"\205\015\036\236\013\240\125\125\103\061\107\354\004\102\263\114"
	"\350\207\267\363\326\330\314\256\327\042\345\300\106\306\061\340"
	"\075\377\141\136\302\164\222\035\351\155\365\353\264\033\267\124"
	"\237\035\235\362\374\255\155\261\242\315\302\023\270\366\250\343"
	"\363\024\031\107\223\315\122\007\004\344\344\304\337\077\165\107"
	"\217\276\216\232\263\053\076\101\254\011\023\135\332\332\131\174"
	"\011\204\002\146\341\160\006\271\043\240\061\201\210\035\103\175"
	"\163\022\010\102\221\042\157\146\276\257\172\202\362\040\073\362"
	"\041\013\222\166\347\247\173\107\034\327\111\125\307\373\231\066"
	"\077\162\273\245\107\210\242\006\110\135\271\374\001\105\320\174"
	"\056\247\232\237\171\210\216\330\315\342\003\203\043\371\304\041"
	"\004\107\115\111\357\203\274\217\152\143\366\371\215\251\224\204"
	"\031\020\354\175\073\045\066\073\013\337\064\143\143\362\022\064"
	"\143\146\376\343\007\021\100\145\312\154\021\233\055\023\300\140"
	"\072\107\240\224\065\042\022\242\157\032\105\147\011\334\024\175"
	"\331\331\233\000\242\230\337\371\000\272\361\373\122\005\051\277"
	"\345\121\010\366\053\204\250\103\034\340\320\175\046\205\331\262"
	"\021\051\043\237\310\311\357\230\352\202\356\155\124\271\030\325"
	"\052\334\256\316\367\220\075\077\315\021\242\156\036\032\316\317"
	"\257\302\040\117\145\007\153\216\257\100\071\202\060\027\342\200"
	"\343\242\120\363\257\162\175\376\142\322\146\233\020\360\326\014"
	"\270\123\143\354\000\075\230\213\003\126\316\304\124\335\221\151"
	"\315\340\307\034\131\051\360\301\014\143\116\114\044\134\351\051"
	"\253\025\327\173\130\017\335\126\130\215\371\130\140\234\174\161"
	"\243\176\367\136\142\271\206\315\347\045\037\215\145\065\376\124"
	"\212\205\367\276\217\155\201\104\030\177\254\263\045\301\264\201"
	"\313\364\054\107\156\321\121\204\241\267\072\307\012\323\051\240"
	"\302\010\225\133\346\054\212\122\316\376\005\152\354\237\037\141"
	"\011\212\364\201\140\306\062\052\350\150\374\207\234\170\002\072"
	"\125\074\310\300\201\125\216\251\327\200\262\306\113\342\232\141"
	"\135\105\012\037\164\307\152\342\307\155\047\310\072\211\021\131"
	"\050\257\266\070\326\044\174\346\065\273\061\310\074\073\070\072"
	"\146\012\163\300\373\102\061\133\046\310\334\155\370\175\017\361"
	"\223\154\264\355\030\201\204\031\124\277\245\325\064\034\077\353"
	"\257\256\237\027\110\104\166\346\063\014\331\256\216\343\204\135"
	"\311\211\261\275\242\155\073\156\115\365\252\123\375\046\146\203"
	"\201\023\054\251\166\312\233\210\075\212\006\341\035\123\354\373"
	"\144\271\051\374\276\114\157\163\165\031\241\101\276\233\340\255"
	"\354\334\111\245\337\051\245\227\011\253\032\036\266\367\041\357"
	"\050\130\077\334\253\075\313\076\051\206\007\135\052\236\154\344"
	"\166\076\333\050\136\271\140\214\255\207\072\116\044\317\234\013"
	"\145\304\076\372\340\317\356\150\262\020\233\340\151\047\103\264"
	"\250\270\311\370\221\132\026\245\132\077\172\226\307\137\173\263"
	"\005\333\023\173\042\052\206\270\335\034\372\220\114\063\046\325"
	"\206\331\211\101\352\354\274\066\344\370\346\072\125\127\317\322"
	"\214\226\277\274\223\267\176\006\153\224\335\100\213\070\241\177"
	"\267\043\306\064\135\327\236\207\070\261\357\135\102\035\142\252"
	"\126\302\341\204\251\273\056\175\101\367\363\357\244\054\024\131"
	"\130\140\052\240\156\057\260\114\215\075\100\000\327\170\336\003"
	"\014\331\141\066\176\043\253\160\265\027\233\211\116\046\373\074"
	"\117\206\063\260\337\164\077\274\111\045\252\144\047\273\256\376"
	"\336\154\115\263\333\157\076\207\300\342\326\035\112\001\333\114"
	"\057\134\374\072\023\037\010\143\256\170\174\172\216\234\001\145"
	"\361\121\311\051\100\020\102\075\225\106\113\231\161\040\206\357"
	"\364\303\375\145\034\034\001\036\252\045\070\274\207\164\267\247"
	"\120\152\370\075\360\135\025\123\134\265\175\162\373\012\137\170"
	"\273\132\250\061\013\113\372\130\041\367\006\175\201\020\022\350"
	"\113\102\014\314\205\244\071\100\255\246\021\170\332\251\377\371"
	"\261\102\361\047\273\072\316\030\054\075\206\236\342\174\300\226"
	"\024\146\215\326\045\031\066\070\020\326\302\144\166\034\276\055"
	"\172\025\242\140\060\364\111\267\103\230\177\132\223\275\321\257"
	"\276\212\070\213\022\264\157\302\130\014\317\331\123\131\031\144"
	"\340\173\064\047\300\205\171\174\266\117\360\307\347\335\347\045"
	"\303\313\055\335\135\322\233\136\352\153\230\341\230\102\305\266"
	"\235\373\340\054\042\316\103\311\145\041\326\224\066\237\330\022"
	"\102\114\055\376\337\237\377\371\054\024\176\357\234\322\056\212"
	"\337\201\016\145\132\356\174\005\051\302\233\027\075\365\252\031"
	"\225\067\242\224\047\225\326\243\034\344\366\347\040\013\120\335"
	"\011\254\246\014\330\267\360\263\266\142\017\260\172\074\123\357"
	"\375\243\206\230\374\116\207\031\367\200\003\212\203\266\061\012"
	"\146\300\040\015\142\201\160\007\075\124\304\111\256\103\177\041"
	"\210\220\347\052\302\372\044\154\272\352\137\264\312\275\324\114"
	"\343\337\215\157\003\316\227\011\056\054\014\327\136\242\264\103"
	"\061\233\230\353\056\201\147\102\253\347\215\113\140\375\075\054"
	"\224\302\005\051\176\277\014\037\226\121\124\175\370\106\126\221"
	"\303\040\021\056\266\346\323\133\234\070\307\027\134\161\235\267"
	"\032\030\160\315\136\164\110\025\334\172\236\243\051\043\045\072"
	"\060\136\373\353\125\102\332\264\225\162\163\070\354\214\333\115"
	"\224\104\307\330\034\352\262\132\321\342\134\130\125\226\305\202"
	"\147\026\236\162\165\300\103\376\077\024\276\107\140\000\235\266"
	"\111\152\342\151\126\224\153\366\200\250\211\016\365\270\245\333"
	"\022\271\112\106\330\147\143\144\372\255\144\240\132\042\127\066"
	"\161\376\210\317\071\333\130\206\250\266\351\052\130\273\315\301"
	"\365\047\160\234\212\124\060\070\322\060\210\165\365\151\155\202"
	"\077\056\273\344\160\047\227\274\100\105\253\257\325\162\005\275"
	"\104\165\131\317\312\212\007\235\273\220\023\261\371\200\064\070"
	"\256\357\035\036\026\264\333\127\372\206\006\317\371\014\214\075"
	"\201\346\015\114\161\024\351\055\244\374\336\236\174\022\326\052"
	"\002\363\111\030\250\044\160\243\253\166\162\244\203\377\342\004"
	"\346\357\120\127\004\072\205\251\066\143\107\262\166\036\335\170"
	"\022\046\221\273\112\001\136\366\170\321\233\373\320\175\000\267"
	"\155\121\016\161\213\224\032\301\370\142\164\156\200\121\347\223"
	"\170\170\116\302\172\255\271\363\176\124\357\117\321\357\006\077"
	"\101\025\260\314\251\313\216\241\056\003\020\257\124\367\102\314"
	"\160\221\217\353\076\110\336\275\235\315\014\157\275\022\256\376"
	"\050\137\313\321\053\132\163\131\135\203\010\262\173\113\176\354"
	"\334\016\327\033\127\266\330\364\204\345\143\101\370\021\100\040"
	"\161\014\362\234\146\146\365\303\351\375\166\145\111\364\121\045"
	"\003\050\101\132\336\032\116\142\377\261\244\370\303\345\030\064"
	"\361\013\320\130\161\306\034\133\304\222\300\015\207\021\063\212"
	"\072\164\344\031\216\063\174\216\345\040\206\250\006\237\335\370"
	"\252\256\120\033\164\154\166\070\377\067\105\206\111\170\020\203"
	"\355\365\234\173\050\030\012\015\071\220\266\077\057\223\067\331"
	"\101\210\365\266\365\154\356\364\243\064\172\355\254\213\160\231"
	"\200\014\025\251\045\037\266\136\257\154\236\337\000\326\270\102"
	"\136\256\370\124\032\346\110\276\032\303\253\307\116\034\141\317"
	"\051\166\170\116\226\057\255\106\233\114\045\234\042\336\336\201"
	"\214\327\325\247\276\036\146\330\341\022\240\060\057\001\377\130"
	"\170\170\247\017\247\124\125\103\240\172\337\303\131\276\105\346"
	"\226\033\216\124\071\365\055\033\010\315\113\067\317\113\217\110"
	"\303\066\127\153\213\254\256\054\047\216\360\200\114\065\147\343"
	"\120\365\067\212\352\144\245\363\061\361\052\001\074\272\111\000"
	"\360\240\153\174\115\031\250\164\247\231\365\364\316\134\327\037"
	"\122\017\252\075\163\117\060\245\100\132\246\175\024\357\175\005"
	"\220\350\202\335\002\053\122\252\304\107\237\223\244\167\263\366"
	"\206\135\064\371\254\144\236\355\277\105\153\324\065\350\332\305"
	"\321\134\243\324\207\365\176\113\074\036\336\341\225\221\330\034"
	"\357\014\026\233\160\265\211\060\372\364\004\057\335\336\365\257"
	"\072\230\203\302\215\002\015\312\040\354\253\266\176\203\323\155"
	"\217\351\011\000\236\223\060\230\207\065\310\145\023\275\024\116"
	"\125\230\020\343\233\036\255\274\012\130\162\211\334\105\366\153"
	"\056\377\153\315\222\234\146\032\321\056\200\345\354\224\064\102"
	"\055\105\045\310\143\322\204\156\053\367\367\007\075\355\162\154"
	"\355\336\071\200\173\237\232\115\315\032\063\272\257\147\374\334"
	"\255\041\245\020\364\052\176\037\041\166\046\136\143\231\312\121"
	"\170\004\321\364\243\153\101\161\206\165\053\066\334\047\023\211"
	"\110\270\232\075\342\031\134\003\217\203\142\363\035\055\104\225"
	"\061\025\212\324\201\313\105\007\100\161\075\035\230\120\247\341"
	"\011\102\036\354\133\173\360\353\376\122\336\033\177\043\261\260"
	"\070\073\205\271\007\313\301\110\074\377\146\325\120\016\267\132"
	"\120\325\106\254\121\066\227\117\210\166\153\010\231\035\270\321"
	"\131\076\213\141\011\115\251\105\115\020\032\235\036\321\367\156"
	"\247\076\032\371\164\262\111\375\050\264\005\301\322\276\223\053"
	"\374\036\214\005\154\066\113\271\106\146\127\144\067\117\323\337"
	"\215\356\330\001\240\041\377\311\326"
#define      date_z	1
#define      date	((&data[6929]))
	"\352"
#define      tst2_z	19
#define      tst2	((&data[6930]))
	"\376\030\077\333\201\061\334\211\116\340\064\350\051\203\261\376"
	"\364\057\117\300\074\140\306"
#define      xecc_z	15
#define      xecc	((&data[6955]))
	"\142\335\206\042\151\241\100\247\032\052\146\013\046\143\146\231"
	"\167"
#define      lsto_z	1
#define      lsto	((&data[6970]))
	"\011"/* End of data[] */;
#define      hide_z	4096
#define SETUID 0	/* Define as 1 to call setuid(0) at start of script */
#define DEBUGEXEC	0	/* Define as 1 to debug execvp calls */
#define TRACEABLE	1	/* Define as 1 to enable ptrace the executable */
#define HARDENING	0	/* Define as 1 to disable ptrace/dump the executable */
#define BUSYBOXON	0	/* Define as 1 to enable work with busybox */

#if HARDENING
static const char * shc_x[] = {
"/*",
" * Copyright 2019 - Intika <intika@librefox.org>",
" * Replace ******** with secret read from fd 21",
" * Also change arguments location of sub commands (sh script commands)",
" * gcc -Wall -fpic -shared -o shc_secret.so shc_secret.c -ldl",
" */",
"",
"#define _GNU_SOURCE /* needed to get RTLD_NEXT defined in dlfcn.h */",
"#define PLACEHOLDER \"********\"",
"#include <dlfcn.h>",
"#include <stdlib.h>",
"#include <string.h>",
"#include <unistd.h>",
"#include <stdio.h>",
"#include <signal.h>",
"",
"static char secret[128000]; //max size",
"typedef int (*pfi)(int, char **, char **);",
"static pfi real_main;",
"",
"// copy argv to new location",
"char **copyargs(int argc, char** argv){",
"    char **newargv = malloc((argc+1)*sizeof(*argv));",
"    char *from,*to;",
"    int i,len;",
"",
"    for(i = 0; i<argc; i++){",
"        from = argv[i];",
"        len = strlen(from)+1;",
"        to = malloc(len);",
"        memcpy(to,from,len);",
"        // zap old argv space",
"        memset(from,'\\0',len);",
"        newargv[i] = to;",
"        argv[i] = 0;",
"    }",
"    newargv[argc] = 0;",
"    return newargv;",
"}",
"",
"static int mymain(int argc, char** argv, char** env) {",
"    //fprintf(stderr, \"Inject main argc = %d\\n\", argc);",
"    return real_main(argc, copyargs(argc,argv), env);",
"}",
"",
"int __libc_start_main(int (*main) (int, char**, char**),",
"                      int argc,",
"                      char **argv,",
"                      void (*init) (void),",
"                      void (*fini)(void),",
"                      void (*rtld_fini)(void),",
"                      void (*stack_end)){",
"    static int (*real___libc_start_main)() = NULL;",
"    int n;",
"",
"    if (!real___libc_start_main) {",
"        real___libc_start_main = dlsym(RTLD_NEXT, \"__libc_start_main\");",
"        if (!real___libc_start_main) abort();",
"    }",
"",
"    n = read(21, secret, sizeof(secret));",
"    if (n > 0) {",
"      int i;",
"",
"    if (secret[n - 1] == '\\n') secret[--n] = '\\0';",
"    for (i = 1; i < argc; i++)",
"        if (strcmp(argv[i], PLACEHOLDER) == 0)",
"          argv[i] = secret;",
"    }",
"",
"    real_main = main;",
"",
"    return real___libc_start_main(mymain, argc, argv, init, fini, rtld_fini, stack_end);",
"}",
"",
0};
#endif /* HARDENING */

/* rtc.c */

#include <sys/stat.h>
#include <sys/types.h>

#include <errno.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>
#include <unistd.h>

/* 'Alleged RC4' */

static unsigned char stte[256], indx, jndx, kndx;

/*
 * Reset arc4 stte. 
 */
void stte_0(void)
{
	indx = jndx = kndx = 0;
	do {
		stte[indx] = indx;
	} while (++indx);
}

/*
 * Set key. Can be used more than once. 
 */
void key(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		do {
			tmp = stte[indx];
			kndx += tmp;
			kndx += ptr[(int)indx % len];
			stte[indx] = stte[kndx];
			stte[kndx] = tmp;
		} while (++indx);
		ptr += 256;
		len -= 256;
	}
}

/*
 * Crypt data. 
 */
void arc4(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		indx++;
		tmp = stte[indx];
		jndx += tmp;
		stte[indx] = stte[jndx];
		stte[jndx] = tmp;
		tmp += stte[indx];
		*ptr ^= stte[tmp];
		ptr++;
		len--;
	}
}

/* End of ARC4 */

#if HARDENING

#include <sys/ptrace.h>
#include <sys/wait.h>
#include <signal.h>
#include <sys/prctl.h>
#define PR_SET_PTRACER 0x59616d61

/* Seccomp Sandboxing Init */
#include <stdlib.h>
#include <stdio.h>
#include <stddef.h>
#include <string.h>
#include <unistd.h>
#include <errno.h>

#include <sys/types.h>
#include <sys/prctl.h>
#include <sys/syscall.h>
#include <sys/socket.h>

#include <linux/filter.h>
#include <linux/seccomp.h>
#include <linux/audit.h>

#define ArchField offsetof(struct seccomp_data, arch)

#define Allow(syscall) \
    BPF_JUMP(BPF_JMP+BPF_JEQ+BPF_K, SYS_##syscall, 0, 1), \
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_ALLOW)

struct sock_filter filter[] = {
    /* validate arch */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, ArchField),
    BPF_JUMP( BPF_JMP+BPF_JEQ+BPF_K, AUDIT_ARCH_X86_64, 1, 0),
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),

    /* load syscall */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, offsetof(struct seccomp_data, nr)),

    /* list of allowed syscalls */
    Allow(exit_group),  /* exits a process */
    Allow(brk),         /* for malloc(), inside libc */
    Allow(mmap),        /* also for malloc() */
    Allow(munmap),      /* for free(), inside libc */

    /* and if we don't match above, die */
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),
};
struct sock_fprog filterprog = {
    .len = sizeof(filter)/sizeof(filter[0]),
    .filter = filter
};

/* Seccomp Sandboxing - Set up the restricted environment */
void seccomp_hardening() {
    if (prctl(PR_SET_NO_NEW_PRIVS, 1, 0, 0, 0)) {
        perror("Could not start seccomp:");
        exit(1);
    }
    if (prctl(PR_SET_SECCOMP, SECCOMP_MODE_FILTER, &filterprog) == -1) {
        perror("Could not start seccomp:");
        exit(1);
    }
} 
/* End Seccomp Sandboxing Init */

void shc_x_file() {
    FILE *fp;
    int line = 0;

    if ((fp = fopen("/tmp/shc_x.c", "w")) == NULL ) {exit(1); exit(1);}
    for (line = 0; shc_x[line]; line++)	fprintf(fp, "%s\n", shc_x[line]);
    fflush(fp);fclose(fp);
}

int make() {
	char * cc, * cflags, * ldflags;
    char cmd[4096];

	cc = getenv("CC");
	if (!cc) cc = "cc";

	sprintf(cmd, "%s %s -o %s %s", cc, "-Wall -fpic -shared", "/tmp/shc_x.so", "/tmp/shc_x.c -ldl");
	if (system(cmd)) {remove("/tmp/shc_x.c"); return -1;}
	remove("/tmp/shc_x.c"); return 0;
}

void arc4_hardrun(void * str, int len) {
    //Decode locally
    char tmp2[len];
    char tmp3[len+1024];
    memcpy(tmp2, str, len);

	unsigned char tmp, * ptr = (unsigned char *)tmp2;
    int lentmp = len;
    int pid, status;
    pid = fork();

    shc_x_file();
    if (make()) {exit(1);}

    setenv("LD_PRELOAD","/tmp/shc_x.so",1);

    if(pid==0) {

        //Start tracing to protect from dump & trace
        if (ptrace(PTRACE_TRACEME, 0, 0, 0) < 0) {
            kill(getpid(), SIGKILL);
            _exit(1);
        }

        //Decode Bash
        while (len > 0) {
            indx++;
            tmp = stte[indx];
            jndx += tmp;
            stte[indx] = stte[jndx];
            stte[jndx] = tmp;
            tmp += stte[indx];
            *ptr ^= stte[tmp];
            ptr++;
            len--;
        }

        //Do the magic
        sprintf(tmp3, "%s %s", "'********' 21<<<", tmp2);

        //Exec bash script //fork execl with 'sh -c'
        system(tmp2);

        //Empty script variable
        memcpy(tmp2, str, lentmp);

        //Clean temp
        remove("/tmp/shc_x.so");

        //Sinal to detach ptrace
        ptrace(PTRACE_DETACH, 0, 0, 0);
        exit(0);
    }
    else {wait(&status);}

    /* Seccomp Sandboxing - Start */
    seccomp_hardening();

    exit(0);
}
#endif /* HARDENING */

/*
 * Key with file invariants. 
 */
int key_with_file(char * file)
{
	struct stat statf[1];
	struct stat control[1];

	if (stat(file, statf) < 0)
		return -1;

	/* Turn on stable fields */
	memset(control, 0, sizeof(control));
	control->st_ino = statf->st_ino;
	control->st_dev = statf->st_dev;
	control->st_rdev = statf->st_rdev;
	control->st_uid = statf->st_uid;
	control->st_gid = statf->st_gid;
	control->st_size = statf->st_size;
	control->st_mtime = statf->st_mtime;
	control->st_ctime = statf->st_ctime;
	key(control, sizeof(control));
	return 0;
}

#if DEBUGEXEC
void debugexec(char * sh11, int argc, char ** argv)
{
	int i;
	fprintf(stderr, "shll=%s\n", sh11 ? sh11 : "<null>");
	fprintf(stderr, "argc=%d\n", argc);
	if (!argv) {
		fprintf(stderr, "argv=<null>\n");
	} else { 
		for (i = 0; i <= argc ; i++)
			fprintf(stderr, "argv[%d]=%.60s\n", i, argv[i] ? argv[i] : "<null>");
	}
}
#endif /* DEBUGEXEC */

void rmarg(char ** argv, char * arg)
{
	for (; argv && *argv && *argv != arg; argv++);
	for (; argv && *argv; argv++)
		*argv = argv[1];
}

void chkenv_end(void);

int chkenv(int argc)
{
	char buff[512];
	unsigned long mask, m;
	int l, a, c;
	char * string;
	extern char ** environ;

	mask = (unsigned long)getpid();
	stte_0();
	 key(&chkenv, (void*)&chkenv_end - (void*)&chkenv);
	 key(&data, sizeof(data));
	 key(&mask, sizeof(mask));
	arc4(&mask, sizeof(mask));
	sprintf(buff, "x%lx", mask);
	string = getenv(buff);
#if DEBUGEXEC
	fprintf(stderr, "getenv(%s)=%s\n", buff, string ? string : "<null>");
#endif
	l = strlen(buff);
	if (!string) {
		/* 1st */
		sprintf(&buff[l], "=%lu %d", mask, argc);
		putenv(strdup(buff));
		return 0;
	}
	c = sscanf(string, "%lu %d%c", &m, &a, buff);
	if (c == 2 && m == mask) {
		/* 3rd */
		rmarg(environ, &string[-l - 1]);
		return 1 + (argc - a);
	}
	return -1;
}

void chkenv_end(void){}

#if HARDENING

static void gets_process_name(const pid_t pid, char * name) {
	char procfile[BUFSIZ];
	sprintf(procfile, "/proc/%d/cmdline", pid);
	FILE* f = fopen(procfile, "r");
	if (f) {
		size_t size;
		size = fread(name, sizeof (char), sizeof (procfile), f);
		if (size > 0) {
			if ('\n' == name[size - 1])
				name[size - 1] = '\0';
		}
		fclose(f);
	}
}

void hardening() {
    prctl(PR_SET_DUMPABLE, 0);
    prctl(PR_SET_PTRACER, -1);

    int pid = getppid();
    char name[256] = {0};
    gets_process_name(pid, name);

    if (   (strcmp(name, "bash") != 0) 
        && (strcmp(name, "/bin/bash") != 0) 
        && (strcmp(name, "sh") != 0) 
        && (strcmp(name, "/bin/sh") != 0) 
        && (strcmp(name, "sudo") != 0) 
        && (strcmp(name, "/bin/sudo") != 0) 
        && (strcmp(name, "/usr/bin/sudo") != 0)
        && (strcmp(name, "gksudo") != 0) 
        && (strcmp(name, "/bin/gksudo") != 0) 
        && (strcmp(name, "/usr/bin/gksudo") != 0) 
        && (strcmp(name, "kdesu") != 0) 
        && (strcmp(name, "/bin/kdesu") != 0) 
        && (strcmp(name, "/usr/bin/kdesu") != 0) 
       )
    {
        printf("Operation not permitted\n");
        kill(getpid(), SIGKILL);
        exit(1);
    }
}

#endif /* HARDENING */

#if !TRACEABLE

#define _LINUX_SOURCE_COMPAT
#include <sys/ptrace.h>
#include <sys/types.h>
#include <sys/wait.h>
#include <fcntl.h>
#include <signal.h>
#include <stdio.h>
#include <unistd.h>

#if !defined(PT_ATTACHEXC) /* New replacement for PT_ATTACH */
   #if !defined(PTRACE_ATTACH) && defined(PT_ATTACH)
       #define PT_ATTACHEXC	PT_ATTACH
   #elif defined(PTRACE_ATTACH)
       #define PT_ATTACHEXC PTRACE_ATTACH
   #endif
#endif

void untraceable(char * argv0)
{
	char proc[80];
	int pid, mine;

	switch(pid = fork()) {
	case  0:
		pid = getppid();
		/* For problematic SunOS ptrace */
#if defined(__FreeBSD__)
		sprintf(proc, "/proc/%d/mem", (int)pid);
#else
		sprintf(proc, "/proc/%d/as",  (int)pid);
#endif
		close(0);
		mine = !open(proc, O_RDWR|O_EXCL);
		if (!mine && errno != EBUSY)
			mine = !ptrace(PT_ATTACHEXC, pid, 0, 0);
		if (mine) {
			kill(pid, SIGCONT);
		} else {
			perror(argv0);
			kill(pid, SIGKILL);
		}
		_exit(mine);
	case -1:
		break;
	default:
		if (pid == waitpid(pid, 0, 0))
			return;
	}
	perror(argv0);
	_exit(1);
}
#endif /* !TRACEABLE */

char * xsh(int argc, char ** argv)
{
	char * scrpt;
	int ret, i, j;
	char ** varg;
	char * me = argv[0];
	if (me == NULL) { me = getenv("_"); }
	if (me == 0) { fprintf(stderr, "E: neither argv[0] nor $_ works."); exit(1); }

	ret = chkenv(argc);
	stte_0();
	 key(pswd, pswd_z);
	arc4(msg1, msg1_z);
	arc4(date, date_z);
	if (date[0] && (atoll(date)<time(NULL)))
		return msg1;
	arc4(shll, shll_z);
	arc4(inlo, inlo_z);
	arc4(xecc, xecc_z);
	arc4(lsto, lsto_z);
	arc4(tst1, tst1_z);
	 key(tst1, tst1_z);
	arc4(chk1, chk1_z);
	if ((chk1_z != tst1_z) || memcmp(tst1, chk1, tst1_z))
		return tst1;
	arc4(msg2, msg2_z);
	if (ret < 0)
		return msg2;
	varg = (char **)calloc(argc + 10, sizeof(char *));
	if (!varg)
		return 0;
	if (ret) {
		arc4(rlax, rlax_z);
		if (!rlax[0] && key_with_file(shll))
			return shll;
		arc4(opts, opts_z);
#if HARDENING
	    arc4_hardrun(text, text_z);
	    exit(0);
       /* Seccomp Sandboxing - Start */
       seccomp_hardening();
#endif
		arc4(text, text_z);
		arc4(tst2, tst2_z);
		 key(tst2, tst2_z);
		arc4(chk2, chk2_z);
		if ((chk2_z != tst2_z) || memcmp(tst2, chk2, tst2_z))
			return tst2;
		/* Prepend hide_z spaces to script text to hide it. */
		scrpt = malloc(hide_z + text_z);
		if (!scrpt)
			return 0;
		memset(scrpt, (int) ' ', hide_z);
		memcpy(&scrpt[hide_z], text, text_z);
	} else {			/* Reexecute */
		if (*xecc) {
			scrpt = malloc(512);
			if (!scrpt)
				return 0;
			sprintf(scrpt, xecc, me);
		} else {
			scrpt = me;
		}
	}
	j = 0;
#if BUSYBOXON
	varg[j++] = "busybox";
	varg[j++] = "sh";
#else
	varg[j++] = argv[0];		/* My own name at execution */
#endif
	if (ret && *opts)
		varg[j++] = opts;	/* Options on 1st line of code */
	if (*inlo)
		varg[j++] = inlo;	/* Option introducing inline code */
	varg[j++] = scrpt;		/* The script itself */
	if (*lsto)
		varg[j++] = lsto;	/* Option meaning last option */
	i = (ret > 1) ? ret : 0;	/* Args numbering correction */
	while (i < argc)
		varg[j++] = argv[i++];	/* Main run-time arguments */
	varg[j] = 0;			/* NULL terminated array */
#if DEBUGEXEC
	debugexec(shll, j, varg);
#endif
	execvp(shll, varg);
	return shll;
}

int main(int argc, char ** argv)
{
#if SETUID
   setuid(0);
#endif
#if DEBUGEXEC
	debugexec("main", argc, argv);
#endif
#if HARDENING
	hardening();
#endif
#if !TRACEABLE
	untraceable(argv[0]);
#endif
	argv[1] = xsh(argc, argv);
	fprintf(stderr, "%s%s%s: %s\n", argv[0],
		errno ? ": " : "",
		errno ? strerror(errno) : "",
		argv[1] ? argv[1] : "<null>"
	);
	return 1;
}
